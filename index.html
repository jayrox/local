<!DOCTYPE html>
<html>

<head>
    <title>Local</title>
</head>

<body>
    <pre id="local_results"></pre>
    <hr>
    <div id="container"></div>
    <script async>
        function logLine(resultList, text) {
            const span = document.createElement('span');
            span.innerHTML = `${text}\n`;
            resultList.appendChild(span);
            resultList.scrollTop = resultList.scrollHeight;
        }
        function addContent(container, url, text) {
            const div = document.createElement('div');
            div.innerHTML = text
            div.setAttribute('id', url);
            div.style.border = '1px solid black';
            div.style.display = 'block';
            div.style.margin = '5px';
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        const localResultList = document.getElementById('local_results');
        const container = document.getElementById('container');
        const portsToTry = [
            80, 81, 88,
            3000, 3001, 3030, 3031, 3333,
            4000, 4001, 4040, 4041, 4444,
            5000, 5001, 5050, 5051, 5555,
            6000, 6001, 6060, 6061, 6666,
            7000, 7001, 7070, 7071, 7777,
            8000, 8001, 8080, 8081, 8888,
            9000, 9001, 9090, 9091, 9999,
        ];


        portsToTry.forEach(async (port) => {
            let res;
            let url;

            // http
            url = `http://localhost:${port}`;
            try {
                res = await fetch(url);
                if (res.ok) {
                    console.log(`Connected: ${url}`);
                    const t = await res.text();
                    console.log(t)
                    await addContent(container, url, t)
                    logLine(localResultList, `<a href="${url}" rel="noopener" target="_blank">${url}</a>`);
                }
            } catch (e) {
                console.log(`${url} - ${e.message}`);
            }

            // https
            url = `https://localhost:${port}`;
            try {
                res = await fetch(url);
                if (res.ok) {
                    console.log(`Connected: ${url}`);
                    logLine(localResultList, `<a href="${url}" rel="noopener" target="_blank">${url}</a>`);
                }
            } catch (e) {
                console.log(`${url} - ${e.message}`);
            }
        });
    </script>
</body>

</html>
